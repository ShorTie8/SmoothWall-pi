.\" beep2 マニュアル
.\" 作成者: 山口 真悟 <shingo@kip.iis.toyama-u.ac.jp>
.TH BEEP2 1 beep2-1.2
.SH 名前
beep2 \- いろいろな長さと音程のビープ音を鳴らす
.SH 書式
.in +.5i
.ti -.5i
.B beep2
\%[-dfs]
\%[-t tempo]
\%[file]
.LP
.B beep2
\%-v
.in -.5i
.SH 説明
このマニュアルページは Josef Pavlik (jetset@ibm.net) によって開発された \fIbeep\fR から派生した \fIbeep2\fR について書いている。
.LP
\fIbeep2\fR は、標準入力又はテキストファイルから音の周波数又は音階と長さを受け取り、それをビープとして発音する。入力のフォーマットは
.B 入力フォーマット
節で説明している。
.SS オプション
.TP
.I "\-d"
デバッグモード。プログラムで処理中の情報を逐次表示する。
.TP
.I "\-f"
周波数入力モード(デフォルト)。音程を周波数の高低で与える。これは console beep V0.1 と同じ動作である。
.TP
.I "\-s"
音階入力モード。音程をアルファベットと数字(# を含む)の組み合せで与える。
.TP
.I "\-t tempo"
テンポ変換。テンポを \fItempo\fR % に変換する。デフォルトの値は 100 。
.TP
.I "\-v"
プログラムのバージョンと組み込み機能を表示して終了する。
.SH 入力フォーマット
\fIbeep2\fR はテキストを行単位で処理する。# から始まる行又は空行はコメント行として無視される。また、長さの指定後の文字列はコメント行として無視される。通常の音指定行は空白又はタブ文字で区切られた 2 個のフィールドから成る。このフォーマットに合わない行は解析エラー行として無視される。周波数が 0 のときは音が鳴らない(休符)となる。
.SS 周波数入力モード
このモードでは第 1 フィールドに音の周波数を Hz 単位で指定し、第 2 フィールドに音の長さをミリ秒単位で指定する。例えば以下のようになる。
.nf
.in +.5i
#!/usr/bin/beep2 -d

1046    200     # C6
1046    100     # C6
0       100     # rest
.in -.5i
.fi
.SS 音階入力モード
このモードでは第 1 フィールドに音程をアルファベットと数字(と # 記号)で指定し、第 2 フィールドに音の長さをミリ秒単位で指定する。例えば以下のようになる。
.nf
.in +.5i
#!/usr/bin/beep2 -ds

C6      200     # C6
C6      100     # C6
C6#     100     # C6#
---     100     # rest
.in -.5i
.fi
音階の ド,レ,ミ,ファ,ソ,ラ,シ はそれぞれ C,D,E,F,G,A,B に対応しており、オクターブは 1 〜 9 まで指定できる。
.LP
なお、指定できる音階は C1 から B9 までであり、C4 がト音記号における下第1線の\*(lqド\*(rq となる。また、休符は - に対応する。
.SH 制限
\fIbeep2\fR はエスケープシーケンスコードを利用して音程を作っているので以下のような制限がある。
.SS 約 20 Hz 以下又は約 20000 Hz 以上の音が聞こえない
人間の可聴領域を越えているためであり、聞こえる動物には聞こえているはずである。
.SS C1 より低い音又は B9 より高い音の指定ができない
実用的な音程は上記の範囲で収まっているはずであるし、人間の可聴領域を越えて
しまうため。
.SS 約 10 ms 以下の音程の切り替えができない
音程の切り替えに約 10 ms かかるのでこれ以下の長さを指定すると音が鳴らない。
.SS Linux において 2000 ms 以上の長さの音が鳴らない
これは Linux カーネルのコンソールドライバの制限によるもので、ソースパッケージ付属の longbeep-linux.patch をカーネルに対して適用することでこの制限を 9999 ms まで拡張することができる。
.LP
もしソースパッケージではなくてバイナリパッケージで入手した場合は beep2 作者の Web ページでこのパッチを入手する必要がある。
.SH ログ機能
\fIbeep2\fR version 1.2 から、syslog を使ったログ機能が追加されており、コンパイル時に有効にすることで使用することができる。もしバイナリパッケージを手に入れたなら -v オプションをつけて起動し、ログ機能が有効になっているか確かめることができる。もしログ機能が必要ないなら \fIbeep2\fR 作者のページでログ機能を無効にしたバイナリパッケージを用意しているのでそちらを使って欲しい。
.LP
ログは user.info の優先度で syslog に送られるため、一般的なシステムの場合 /var/log/messages に書き出される。ログにはコマンドを使用した実ユーザ名とそのときのコマンドライン文字列が記録される。
.LP
syslog.conf (一般的には /etc にある)を編集することでログの出力先を変更することができる。詳しくは syslog のドキュメントを参照すること。
.SH セキュリティ上の警告
\fIbeep2\fR は root に setuid されてインストールされる。このためバッファオーバーフローなどのセキュリティホールを突くために利用される恐れがある。各サイトのセキュリティーポリシーと照らし合わせて、プログラムの実行権限を適切に設定する必要がある。
.SH バグ
このソフトはまだ十分にテストされていないのでまだ多くのバグが潜んでいると思われる。もしバグと思われる現象を発見したなら \fIbeep2\fR の作者まで知らせて欲しい。
.SH 著者
山口 真悟(shingo@kip.iis.toyama-u.ac.jp)
